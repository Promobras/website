<!--[if lte IE 8]><script src="{{ "assets/js/ie/respond.min.js" | absURL }}"></script><![endif]-->
<script src="{{ "assets/js/app.min.js" | absURL }}"></script>
{{ if (getenv "HUGO_ENV") "production" -}}
<script type="text/javascript">
  var my_breakpoints = [
    200,
    400,
    800,
    1080,
    1600,
    1920,
    3840,
    5760
  ]
  var cl = cloudinary.Cloudinary.new({cloud_name: "{{ $.Site.Params.cloudinary }}"})
  cl.config({breakpoints:my_breakpoints, responsive_use_breakpoints: true})
  cl.responsive()
</script>
{{ end -}}
<script>
var map = []
var marker = []
function initMaps() {
  $('.map').each(function(index) {
    let coords = {lat: -12.6346871, lng: -58.2792325}
    let showMarker = false
    let zoom = 4
    let lat = parseFloat($(this).attr('data-lat'))
    let lng = parseFloat($(this).attr('data-lng'))
    let zoomAttr = parseInt($(this).attr('data-zoom'))
    if (lat && lng) {
      coords = {lat: lat, lng: lng}
      showMarker = true
      if (zoomAttr) {
        zoom = zoomAttr
      }
    }

    var id = 'map' + index
    $(this).attr('id', id)
    
    map[index] = new google.maps.Map(document.getElementById(id), {
      zoom: zoom,
      center: coords
    })
    if (showMarker) {
      marker[index] = new google.maps.Marker({
        position: coords,
        map: map[index]
      })
    }

    var placeId = $(this).attr('data-placeid')
    if (placeId) {
      var geocoder = new google.maps.Geocoder();
      geocoder.geocode({'placeId': placeId}, function(results, status) {
        if (status === 'OK' && status[0]) {
          if (zoomAttr) {
            map[index].setZoom(zoomAttr)
          }
          map[index].setCenter(results[0].geometry.location)
          marker[index].setPlace({
            placeId: placeId,
            location: results[0].geometry.location
          })
        }
      })
    }

  })
}
</script>
<script async defer src="https://maps.googleapis.com/maps/api/js?key={{ $.Site.Params.googleapis.map }}&language=fr&callback=initMaps"></script>
