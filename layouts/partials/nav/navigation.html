{{/* Check https://github.com/bep/hugotest */}}
{{ $root := (.Site.GetPage "section" .Section) }}
<div>
  <ul>
  {{ with $root -}}
    <li><a href="{{ .RelPermalink}}">{{ if .LinkTitle }}{{ .LinkTitle }}{{ else }}{{ .Title }}{{ end }}</a></li>
    {{ template "section-tree-nav"  (dict "root" . "current" $ ) -}}
    {{ range .Pages }}
      <li><a href="{{ .RelPermalink}}">{{ if .LinkTitle }}{{ .LinkTitle }}{{ else }}{{ .Title }}{{ end }}</a></li>
    {{ end }}
  {{ end -}}
  </ul>
</div>
{{ define "section-tree-nav" }}
  {{ range .root.Sections}}
  	<li><a href="{{ .RelPermalink}}">{{ if .LinkTitle }}{{ .LinkTitle }}{{ else }}{{ .Title }}{{ end }}</a></li>
    {{ $pages := where .Pages ".Params.hidden" "!=" "true" }}
    {{ if gt (len $pages) 0}}
    <ul>
      {{ range $pages -}}
      	<li><a href="{{ .RelPermalink}}">{{ if .LinkTitle }}{{ .LinkTitle }}{{ else }}{{ .Title }}{{ end }}</a></li>
      {{ end }}
    </ul>
    {{ end }}
    {{ template "section-tree-nav" (dict "root" . "current" $.current ) -}}
  {{ end }}
{{ end }}
